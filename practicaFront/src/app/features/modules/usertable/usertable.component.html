<h2 class="text-center text-bg-success">
  Usuarios
</h2>


<p-table #dt [value]="tableData"
         [paginator]="true"
         [rows]="5"
         [scrollable]="false"
         [tableStyle]="{ 'min-width': '50rem' }"
         [rowsPerPageOptions]="[5, 10, 20]"
         [globalFilterFields]=
           "['firstName', 'lastName', 'email']">

  <ng-template pTemplate="caption">

    <div style="text-align: right">
      <p-button *ngIf="currentUser.role.roleName === 'admin'" label="Create"/>
      <i class="pi pi-search"
         style="margin:4px 4px 0 0"> </i>
      <input type="text" pInputText
             size="50"
             placeholder="Escribe aqui para buscar"
             style="width:auto"
      />
      <!-- Error al implementar el fitlrado de resultados -->
      <!--             (input)="dt?.filterGlobal($event.target.value, 'contains')"-->

    </div>
  </ng-template>

  <ng-template pTemplate="header">
    <tr>
      <th>Id</th>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Email</th>
      <th>Role</th>
      <th>Actions</th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-user>
    <tr>
      <td>
        {{ user.userId }}
      </td>
      <td>
        {{ user.firstName }}
      </td>
      <td>
        {{ user.lastName }}
      </td>
      <td>
        {{ user.email }}
      </td>
      <td>
        {{ user.role?.roleName || "n/a" }}
      </td>
      <td *ngIf="currentUser.role?.roleName === 'admin'">
        <p-button id="editBtn" (click)="showDialog(user, 'edit')" label="Edit"/>
        <p-button (click)="deleteUser(user.userId)">Eliminar</p-button>
      </td>
    </tr>

  </ng-template>
</p-table>

<p-dialog header="Edit Profile" [modal]="true" [(visible)]="visible" [style]="{ width: '25rem'}">

    <span class="p-text-secondary block mb-8">
    {{ eventTrigger === 'edit' ? 'Create new user.' : 'Update user information.' }}
  </span>
  <div class="flex items-center gap-4 mb-4">
    <label for="FirstName" class="font-semibold w-24">FirstName</label>
    <input pInputText id="FirstName" class="flex-auto" autocomplete="off" [(ngModel)]="editableUser.firstName"
           name="firstName"/>
  </div>
  <div class="flex items-center gap-4 mb-8">
    <label for="LastName" class="font-semibold w-24">LastName</label>
    <input pInputText id="LastName" class="flex-auto" autocomplete="off" [(ngModel)]="editableUser.lastName"
           name="lastName"/>
  </div>
  <div class="flex items-center gap-4 mb-8">
    <label for="email" class="font-semibold w-24">Email</label>
    <input pInputText id="email" class="flex-auto" autocomplete="off"
           [(ngModel)]="editableUser.email" name="email"
    />
  </div>
  <div class="flex justify-end gap-2">
    <p-button label="Cancel" severity="secondary" (click)="visible = false"/>

    <p-button label="Save" (click)="updateUser()"/>
  </div>
</p-dialog>
